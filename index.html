<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>极简语音测试</title>
</head>
<body>
  <button onclick="startRec()">点击说话</button>
  <div id="res"></div>

  <script>
    // 仅保留核心识别逻辑，无任何多余代码
    function startRec() {
      const res = document.getElementById('res');
      // 检测浏览器支持
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        res.innerText = '浏览器不支持，用Chrome/Edge';
        return;
      }

      const rec = new SpeechRecognition();
      rec.lang = 'zh-CN'; // 中文
      rec.continuous = false; // 只识别一次
      rec.interimResults = false; // 只返回最终结果

      res.innerText = '正在听...';
      rec.start();

      // 识别成功
      rec.onresult = (e) => {
        res.innerText = '识别结果：' + e.results[0][0].transcript;
      };

      // 识别失败（关键：显示具体错误）
      rec.onerror = (err) => {
        res.innerText = '错误原因：' + err.error;
      };

      // 识别结束
      rec.onend = () => {
        if (res.innerText === '正在听...') res.innerText = '未识别到声音';
      };
    }
  </script>
</body>
</html>
